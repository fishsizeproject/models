<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carl Smith">
<meta name="dcterms.date" content="2022-11-23">

<title>Sustainable Inland Fisheries - R code for Bayesian CPUE time series standardisation using INLA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/sif_sm.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Sustainable Inland Fisheries</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://fishsizeproject.github.io/models/lt/index.html" rel="">
 <span class="menu-text">Lietuvi≈≥</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://fishsizeproject.github.io/models/index.html" rel="">
 <span class="menu-text">English</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">R code for Bayesian CPUE time series standardisation using INLA</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../models.html" class="sidebar-item-text sidebar-link">LITHUANIAN: Overview of models</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">CPUE standardisation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GLM_standardisation.html" class="sidebar-item-text sidebar-link">1. LITHUANIAN: GLM based standardisation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Zero_inflated_model.html" class="sidebar-item-text sidebar-link">2. Zero inflated model for catch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Bayesian_inla.html" class="sidebar-item-text sidebar-link">3. Bayesian model</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Surplus production (SP) models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../surplus-production.html" class="sidebar-item-text sidebar-link">4. Understand SP models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../jabba_models.html" class="sidebar-item-text sidebar-link">5. SP models with JABBA</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Fish growth models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../von-bertalanffy.html" class="sidebar-item-text sidebar-link">6. Von-Bertallanfy growth</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../temperature_growth.html" class="sidebar-item-text sidebar-link">7. Temperature impacts on growth</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../growth_change.html" class="sidebar-item-text sidebar-link">8. Detecting growth changes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../detecting_size.html" class="sidebar-item-text sidebar-link">9. Detecting size changes</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Machine learning (ML) models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ML_fish_species.html" class="sidebar-item-text sidebar-link">10. ML for species identification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ML_fish_size.html" class="sidebar-item-text sidebar-link">11. ML for fish size estimation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Satellite data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../satelite_temp.html" class="sidebar-item-text sidebar-link">12. Getting temperature data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../satelite_chla.html" class="sidebar-item-text sidebar-link">13. Getting chlA data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Size based ecosystem models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../curonian_mizer.html" class="sidebar-item-text sidebar-link">14. Curonian lagoon model</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">≈†iame puslapyje</h2>
   
  <ul>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link active" data-scroll-target="#data-exploration"><em>Data exploration</em></a>
  <ul class="collapse">
  <li><a href="#check-outliers" id="toc-check-outliers" class="nav-link" data-scroll-target="#check-outliers"><em>Check outliers</em></a></li>
  <li><a href="#normality-and-homogeneity-of-variance" id="toc-normality-and-homogeneity-of-variance" class="nav-link" data-scroll-target="#normality-and-homogeneity-of-variance"><em>Normality and homogeneity of variance</em></a></li>
  </ul></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><em>MODEL</em></a>
  <ul class="collapse">
  <li><a href="#fit-increasingly-complex-models" id="toc-fit-increasingly-complex-models" class="nav-link" data-scroll-target="#fit-increasingly-complex-models"><em>Fit increasingly complex models</em></a></li>
  <li><a href="#explore-the-best-model" id="toc-explore-the-best-model" class="nav-link" data-scroll-target="#explore-the-best-model"><em>Explore the best model</em></a></li>
  <li><a href="#plot-model-outputs" id="toc-plot-model-outputs" class="nav-link" data-scroll-target="#plot-model-outputs"><em>Plot model outputs</em></a></li>
  <li><a href="#plot-catch-versus-effort" id="toc-plot-catch-versus-effort" class="nav-link" data-scroll-target="#plot-catch-versus-effort"><em>Plot catch versus effort</em></a></li>
  <li><a href="#plot-cpue-through-time" id="toc-plot-cpue-through-time" class="nav-link" data-scroll-target="#plot-cpue-through-time"><em>Plot CPUE through time</em></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">R code for Bayesian CPUE time series standardisation using INLA</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carl Smith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 23, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p><em>Note that we are using a data file that has already been explored and modified to remove outliers. Read the introduction to the model to see where to find the original data file and explanation on data exploration</em></p>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration"><em>Data exploration</em></h2>
<section id="check-outliers" class="level3">
<h3 class="anchored" data-anchor-id="check-outliers"><em>Check outliers</em></h3>
<p><em>The plots below suggest that there are no outliers in the dataset</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="normality-and-homogeneity-of-variance" class="level3">
<h3 class="anchored" data-anchor-id="normality-and-homogeneity-of-variance"><em>Normality and homogeneity of variance</em></h3>
<p><em>The plots below show that as catches and effort increase, so does the variance. This suggest a departure from the homogeneity of variance.</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model" class="level1">
<h1><em>MODEL</em></h1>
<p><em>Our aim is to Standardise pikeperch gillnet catch (kg) as a function of effort, station, years and months within years. We want to get a standardised time series of abundance. For that we will apply (Bayesian) INLA model for time-series analysis with a random walk model of order 1 (rw1). This model has 2 residual components, trend due to time (year) and pure noise</em></p>
<section id="fit-increasingly-complex-models" class="level2">
<h2 class="anchored" data-anchor-id="fit-increasingly-complex-models"><em>Fit increasingly complex models</em></h2>
<p><em>We start with an intercept only model. Catch is modelled as a function of year, whereas ‚Äòrw1‚Äô part imposes a temporal trend. We fit a gamma distribution using INLA. A gamma distribution is strictly positive (no zeros) and skewed (like our catch data)</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formula</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> Catch <span class="sc">~</span> <span class="sc">+</span> <span class="fu">f</span>(Year, <span class="at">model =</span> <span class="st">"rw1"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#fit a model</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>I1 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f1, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>), <span class="co">#estimate dic for model comparison</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"Gamma"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> zan)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the time(year) trend</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>Yearsm <span class="ot">&lt;-</span> I1<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Fit1   <span class="ot">&lt;-</span> I1<span class="sc">$</span>summary.fitted.values[,<span class="st">"mean"</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yearsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Year'</span>, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The result above shows that if we only look at one trend, we see decreasing catches through time. But effort also might have changed, so we need to include effort in the model.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a formula with effort</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> Catch <span class="sc">~</span> Effort <span class="sc">+</span> <span class="fu">f</span>(Year, <span class="at">model =</span> <span class="st">"rw1"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#fit a model</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>I2 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f2, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"Gamma"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> zan)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#compare two models using a criterion similar to AIC</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I1<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#4179</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4179</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I2<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#3532 &lt;- including Effort improves fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#And plot the trend </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Yearsm <span class="ot">&lt;-</span> I2<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yearsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Year'</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>) )</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Now the trend is clearly different. This is because we are not including effort in the model, which is important. However, we also need to account for potentially different trends across months. So now we will nest month within a year</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a formula</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> Catch <span class="sc">~</span> Effort <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Year, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Mon, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>, <span class="at">cyclic =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the model</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>I3 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f3, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"gamma"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> zan)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#compare with the previous model </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I2<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#3525</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I3<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#3203 &lt;- including month improves fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the trend, but this time we plot it for years and months</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Fit3 <span class="ot">&lt;-</span> I3<span class="sc">$</span>summary.fitted.values[,<span class="st">"mean"</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Yearsm   <span class="ot">&lt;-</span> I3<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yearsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Year'</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>Monsm <span class="ot">&lt;-</span> I3<span class="sc">$</span>summary.random<span class="sc">$</span>Mon</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Monsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'MonthInYear'</span>, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>We can see that catches change a lot during the year and are low in summer months. So we definitely need to include month in the model. Since we have several stations, we probably also need to include stations in the model.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a formula with station as a random term</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> Catch <span class="sc">~</span> Effort <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Year, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Mon, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>, <span class="at">cyclic =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(fStn, <span class="at">model =</span> <span class="st">"iid"</span>) </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the model </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>I4 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f4, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"Gamma"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> zan)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#compare with the previous model </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I3<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#3203</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I4<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#2977 &lt;- including station improves fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot trend across years and months </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Fit4 <span class="ot">&lt;-</span> I4<span class="sc">$</span>summary.fitted.values[,<span class="st">"mean"</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Yearsm   <span class="ot">&lt;-</span> I4<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yearsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Year'</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) )</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>Monsm   <span class="ot">&lt;-</span> I4<span class="sc">$</span>summary.random<span class="sc">$</span>Mon</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Monsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'MonthInYear'</span>, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) )</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="explore-the-best-model" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-best-model"><em>Explore the best model</em></h2>
<p><em>Now we look at the Bayesian residuals</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>These residuals look ok. However, if we fit residuals versus effort we see a strange non linear pattern, which suggests that the model does not fully fit. We will then plot it for each station and find that there seem to be different residual and therefore likely also CPUE trends in different stations.</em></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>To solve this problem we make station a fixed effect and add an interaction with effort to capture non-linearity. If different stations have different catch trends this interaction should be included. So we define a yet another model with Effort * fStn interaction and fit it.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define the model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> Catch <span class="sc">~</span> Effort <span class="sc">*</span> fStn <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Year, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">f</span>(Mon, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">"rw1"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">cyclic =</span> T)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the model </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>I5 <span class="ot">&lt;-</span> <span class="fu">inla</span>(f5, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">config =</span> <span class="cn">TRUE</span>, <span class="at">dic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"Gamma"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">control.family =</span> <span class="fu">list</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> zan)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#compare wit the previous model </span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I4<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#2977 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2977</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(I5<span class="sc">$</span>dic<span class="sc">$</span>dic,<span class="dv">0</span>) <span class="co">#2889 &lt;- big improvement in fit...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2889</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot trends </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Fit5 <span class="ot">&lt;-</span> I5<span class="sc">$</span>summary.fitted.values[,<span class="st">"mean"</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Yearsm   <span class="ot">&lt;-</span> I5<span class="sc">$</span>summary.random<span class="sc">$</span>Year</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yearsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Year'</span>, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yearsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>Monsm   <span class="ot">&lt;-</span> I5<span class="sc">$</span>summary.random<span class="sc">$</span>Mon</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Monsm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'MonthInYear'</span>, </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">'Random walk trend'</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) )</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Monsm[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)], <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Now we look at the residuals of our new model</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the fitted values and Pearson residuals</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>N     <span class="ot">&lt;-</span> <span class="fu">nrow</span>(zan)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>mu2   <span class="ot">&lt;-</span> I5<span class="sc">$</span>summary.fitted.values[<span class="dv">1</span><span class="sc">:</span>N,<span class="st">"mean"</span>] </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>r     <span class="ot">&lt;-</span> I5<span class="sc">$</span>summary.hyperpar[<span class="st">"Precision parameter for the Gamma observations"</span>, <span class="st">"mean"</span>]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>VarY2 <span class="ot">&lt;-</span> mu2<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> r</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>E2    <span class="ot">&lt;-</span> (zan<span class="sc">$</span>Catch <span class="sc">-</span> mu2) <span class="sc">/</span> <span class="fu">sqrt</span>(VarY2)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals versus fitted values.</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mu2, </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> E2,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals versus station</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(E2 <span class="sc">~</span> Station, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> zan)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Year</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(E2 <span class="sc">~</span> Year, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> zan)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Month</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(E2 <span class="sc">~</span> Month, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> zan)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals versus effort</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>zan<span class="sc">$</span>E2 <span class="ot">&lt;-</span> E2</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>resplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> zan, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> E2 ,  </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> Effort)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> zan,                    </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> E2, </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> Effort)) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Effort"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Pearson residuals"</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  My_theme <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>resplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The final plot shows that the significant nonlinear pattern in residuals is mostly gone (uncertainty ranges include zero).</em></p>
</section>
<section id="plot-model-outputs" class="level2">
<h2 class="anchored" data-anchor-id="plot-model-outputs"><em>Plot model outputs</em></h2>
<p><em>First we plots the overall temporal trend in years and months</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot temporal effects</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  I5<span class="sc">$</span>summary.random<span class="sc">$</span>Year <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Year =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">lcl =</span> <span class="dv">4</span>, <span class="at">ucl =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"rw1"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> mean, <span class="at">ymin =</span> lcl, <span class="at">ymax =</span> ucl)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"forestgreen"</span>) <span class="sc">+</span> My_theme <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"firebrick2"</span>, <span class="at">size=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-8891c5e0bcdd22c6feee" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8891c5e0bcdd22c6feee">{"x":{"data":[{"x":[1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2020,2020,2019,2018,2017,2016,2015,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,1999,1998,1998],"y":[0.221164019995247,-0.0436022922843577,-0.107840861234133,-0.19270016041946,-0.0666701334530575,0.286793090004006,0.23346368774968,0.180911347027127,0.0251780325075763,-0.0902867303748789,-0.119119339729643,-0.460330875022203,-0.40738098285438,-0.1374572080084,-0.121197412189926,-0.326533281628329,-0.324952765179352,-0.348136441620741,-0.374202579570055,-0.381356766535674,-0.50141469941581,-0.512219084287053,-0.268641637231719,-0.268641637231719,0.103723028459315,-0.152913888897131,-0.159285048817848,-0.0517272280942402,-0.046365636273264,-0.0231710001841428,-0.00582398869506801,0.00083418793831147,0.19882493385378,0.181622021719071,-0.0730287706333414,-0.108317924821395,0.196949375101694,0.230949772585325,0.348087555179866,0.50423849561423,0.56330876860637,0.631392936308539,0.269110206403306,0.147426581547054,0.21821181060119,0.289728145031289,0.575711857441198,0.221164019995247],"text":["Year: 1998<br />mean:  0.39323729<br />lcl:  0.22116402<br />ucl:  0.5757118574","Year: 1999<br />mean:  0.12289064<br />lcl: -0.04360229<br />ucl:  0.2897281450","Year: 2000<br />mean:  0.05409374<br />lcl: -0.10784086<br />ucl:  0.2182118106","Year: 2001<br />mean: -0.02176119<br />lcl: -0.19270016<br />ucl:  0.1474265815","Year: 2002<br />mean:  0.10179152<br />lcl: -0.06667013<br />ucl:  0.2691102064","Year: 2003<br />mean:  0.45279778<br />lcl:  0.28679309<br />ucl:  0.6313929363","Year: 2004<br />mean:  0.39456449<br />lcl:  0.23346369<br />ucl:  0.5633087686","Year: 2005<br />mean:  0.33856248<br />lcl:  0.18091135<br />ucl:  0.5042384956","Year: 2006<br />mean:  0.18451287<br />lcl:  0.02517803<br />ucl:  0.3480875552","Year: 2007<br />mean:  0.06861558<br />lcl: -0.09028673<br />ucl:  0.2309497726","Year: 2008<br />mean:  0.03410506<br />lcl: -0.11911934<br />ucl:  0.1969493751","Year: 2009<br />mean: -0.28233036<br />lcl: -0.46033088<br />ucl: -0.1083179248","Year: 2010<br />mean: -0.23927167<br />lcl: -0.40738098<br />ucl: -0.0730287706","Year: 2011<br />mean:  0.01675660<br />lcl: -0.13745721<br />ucl:  0.1816220217","Year: 2012<br />mean:  0.03348764<br />lcl: -0.12119741<br />ucl:  0.1988249339","Year: 2013<br />mean: -0.16291228<br />lcl: -0.32653328<br />ucl:  0.0008341879","Year: 2014<br />mean: -0.16736470<br />lcl: -0.32495277<br />ucl: -0.0058239887","Year: 2015<br />mean: -0.18784551<br />lcl: -0.34813644<br />ucl: -0.0231710002","Year: 2016<br />mean: -0.21221645<br />lcl: -0.37420258<br />ucl: -0.0463656363","Year: 2017<br />mean: -0.21954429<br />lcl: -0.38135677<br />ucl: -0.0517272281","Year: 2018<br />mean: -0.33042188<br />lcl: -0.50141470<br />ucl: -0.1592850488","Year: 2019<br />mean: -0.33168383<br />lcl: -0.51221908<br />ucl: -0.1529138889","Year: 2020<br />mean: -0.08699078<br />lcl: -0.26864164<br />ucl:  0.1037230285","Year: 2020<br />mean: -0.08699078<br />lcl: -0.26864164<br />ucl:  0.1037230285","Year: 2020<br />mean: -0.08699078<br />lcl: -0.26864164<br />ucl:  0.1037230285","Year: 2019<br />mean: -0.33168383<br />lcl: -0.51221908<br />ucl: -0.1529138889","Year: 2018<br />mean: -0.33042188<br />lcl: -0.50141470<br />ucl: -0.1592850488","Year: 2017<br />mean: -0.21954429<br />lcl: -0.38135677<br />ucl: -0.0517272281","Year: 2016<br />mean: -0.21221645<br />lcl: -0.37420258<br />ucl: -0.0463656363","Year: 2015<br />mean: -0.18784551<br />lcl: -0.34813644<br />ucl: -0.0231710002","Year: 2014<br />mean: -0.16736470<br />lcl: -0.32495277<br />ucl: -0.0058239887","Year: 2013<br />mean: -0.16291228<br />lcl: -0.32653328<br />ucl:  0.0008341879","Year: 2012<br />mean:  0.03348764<br />lcl: -0.12119741<br />ucl:  0.1988249339","Year: 2011<br />mean:  0.01675660<br />lcl: -0.13745721<br />ucl:  0.1816220217","Year: 2010<br />mean: -0.23927167<br />lcl: -0.40738098<br />ucl: -0.0730287706","Year: 2009<br />mean: -0.28233036<br />lcl: -0.46033088<br />ucl: -0.1083179248","Year: 2008<br />mean:  0.03410506<br />lcl: -0.11911934<br />ucl:  0.1969493751","Year: 2007<br />mean:  0.06861558<br />lcl: -0.09028673<br />ucl:  0.2309497726","Year: 2006<br />mean:  0.18451287<br />lcl:  0.02517803<br />ucl:  0.3480875552","Year: 2005<br />mean:  0.33856248<br />lcl:  0.18091135<br />ucl:  0.5042384956","Year: 2004<br />mean:  0.39456449<br />lcl:  0.23346369<br />ucl:  0.5633087686","Year: 2003<br />mean:  0.45279778<br />lcl:  0.28679309<br />ucl:  0.6313929363","Year: 2002<br />mean:  0.10179152<br />lcl: -0.06667013<br />ucl:  0.2691102064","Year: 2001<br />mean: -0.02176119<br />lcl: -0.19270016<br />ucl:  0.1474265815","Year: 2000<br />mean:  0.05409374<br />lcl: -0.10784086<br />ucl:  0.2182118106","Year: 1999<br />mean:  0.12289064<br />lcl: -0.04360229<br />ucl:  0.2897281450","Year: 1998<br />mean:  0.39323729<br />lcl:  0.22116402<br />ucl:  0.5757118574","Year: 1998<br />mean:  0.39323729<br />lcl:  0.22116402<br />ucl:  0.5757118574"],"type":"scatter","mode":"lines","line":{"width":null,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(34,139,34,0.2)","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],"y":[0.393237288508213,0.122890635571114,0.0540937410932824,-0.0217611945178776,0.101791518345811,0.452797776120456,0.394564493001161,0.338562482695785,0.184512873783056,0.06861558412326,0.034105060340855,-0.28233035691677,-0.239271666361441,0.0167566041112677,0.0334876407856865,-0.162912278863329,-0.167364697518654,-0.187845505148574,-0.212216447568963,-0.219544285612252,-0.330421876725175,-0.331683826809152,-0.0869907839633274],"text":["Year: 1998<br />mean:  0.39323729<br />lcl:  0.22116402<br />ucl:  0.5757118574","Year: 1999<br />mean:  0.12289064<br />lcl: -0.04360229<br />ucl:  0.2897281450","Year: 2000<br />mean:  0.05409374<br />lcl: -0.10784086<br />ucl:  0.2182118106","Year: 2001<br />mean: -0.02176119<br />lcl: -0.19270016<br />ucl:  0.1474265815","Year: 2002<br />mean:  0.10179152<br />lcl: -0.06667013<br />ucl:  0.2691102064","Year: 2003<br />mean:  0.45279778<br />lcl:  0.28679309<br />ucl:  0.6313929363","Year: 2004<br />mean:  0.39456449<br />lcl:  0.23346369<br />ucl:  0.5633087686","Year: 2005<br />mean:  0.33856248<br />lcl:  0.18091135<br />ucl:  0.5042384956","Year: 2006<br />mean:  0.18451287<br />lcl:  0.02517803<br />ucl:  0.3480875552","Year: 2007<br />mean:  0.06861558<br />lcl: -0.09028673<br />ucl:  0.2309497726","Year: 2008<br />mean:  0.03410506<br />lcl: -0.11911934<br />ucl:  0.1969493751","Year: 2009<br />mean: -0.28233036<br />lcl: -0.46033088<br />ucl: -0.1083179248","Year: 2010<br />mean: -0.23927167<br />lcl: -0.40738098<br />ucl: -0.0730287706","Year: 2011<br />mean:  0.01675660<br />lcl: -0.13745721<br />ucl:  0.1816220217","Year: 2012<br />mean:  0.03348764<br />lcl: -0.12119741<br />ucl:  0.1988249339","Year: 2013<br />mean: -0.16291228<br />lcl: -0.32653328<br />ucl:  0.0008341879","Year: 2014<br />mean: -0.16736470<br />lcl: -0.32495277<br />ucl: -0.0058239887","Year: 2015<br />mean: -0.18784551<br />lcl: -0.34813644<br />ucl: -0.0231710002","Year: 2016<br />mean: -0.21221645<br />lcl: -0.37420258<br />ucl: -0.0463656363","Year: 2017<br />mean: -0.21954429<br />lcl: -0.38135677<br />ucl: -0.0517272281","Year: 2018<br />mean: -0.33042188<br />lcl: -0.50141470<br />ucl: -0.1592850488","Year: 2019<br />mean: -0.33168383<br />lcl: -0.51221908<br />ucl: -0.1529138889","Year: 2020<br />mean: -0.08699078<br />lcl: -0.26864164<br />ucl:  0.1037230285"],"type":"scatter","mode":"lines","line":{"width":null,"color":"rgba(34,139,34,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1996.9,2021.1],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.51181102362205,"color":"rgba(238,44,44,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":48.5446243254462,"r":7.30593607305936,"b":47.3557492735575,"l":29.5558322955583},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":22.3163138231631},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1996.9,2021.1],"tickmode":"array","ticktext":["2000","2005","2010","2015","2020"],"tickvals":[2000,2005,2010,2015,2020],"categoryorder":"array","categoryarray":["2000","2005","2010","2015","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.8775425487754},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.569399685316833,0.688573537338318],"tickmode":"array","ticktext":["-0.3","0.0","0.3","0.6"],"tickvals":[-0.3,0,0.3,0.6],"categoryorder":"array","categoryarray":["-0.3","0.0","0.3","0.6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"mean","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.8775425487754}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"f84f151706":{"x":{},"y":{},"ymin":{},"ymax":{},"type":"scatter"},"f84509c7ac2":{"x":{},"y":{},"ymin":{},"ymax":{}},"f84736571c":{"yintercept":{}}},"cur_data":"f84f151706","visdat":{"f84f151706":["function (y) ","x"],"f84509c7ac2":["function (y) ","x"],"f84736571c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  I5<span class="sc">$</span>summary.random<span class="sc">$</span>Mon <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Mon =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">lcl =</span> <span class="dv">4</span>, <span class="at">ucl =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="st">"rw2"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Mon, <span class="at">y =</span> mean, <span class="at">ymin =</span> lcl, <span class="at">ymax =</span> ucl)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"dodgerblue2"</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"dodgerblue2"</span>) <span class="sc">+</span> My_theme <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"firebrick2"</span>, <span class="at">size=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Month within Year"</span>) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-b7f0ec9b83ac8734e601" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b7f0ec9b83ac8734e601">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,12,12,11,10,9,8,7,6,5,4,3,2,1,1],"y":[0.306510402966685,-0.196440740616595,-0.189517788450785,0.493894960750176,0.322374348612468,-0.846312310047639,-2.17033780051383,-1.45504040903593,-0.0706931369587264,0.727782615155189,0.722374132334717,0.574714011288843,0.574714011288843,0.849667426736627,1.01969341691614,1.03934069770528,0.204355907003399,-1.14389749793421,-1.81542085077928,-0.533400386168343,0.613938811694541,0.801946184486272,0.0878808745639047,0.0796758083429801,0.581730929722316,0.306510402966685],"text":["Mon:  1<br />mean:  0.44177942<br />lcl:  0.30651040<br />ucl:  0.58173093","Mon:  2<br />mean: -0.06075172<br />lcl: -0.19644074<br />ucl:  0.07967581","Mon:  3<br />mean: -0.05318649<br />lcl: -0.18951779<br />ucl:  0.08788087","Mon:  4<br />mean:  0.64599498<br />lcl:  0.49389496<br />ucl:  0.80194618","Mon:  5<br />mean:  0.46606820<br />lcl:  0.32237435<br />ucl:  0.61393881","Mon:  6<br />mean: -0.69175357<br />lcl: -0.84631231<br />ucl: -0.53340039","Mon:  7<br />mean: -1.99467099<br />lcl: -2.17033780<br />ucl: -1.81542085","Mon:  8<br />mean: -1.30142336<br />lcl: -1.45504041<br />ucl: -1.14389750","Mon:  9<br />mean:  0.06452193<br />lcl: -0.07069314<br />ucl:  0.20435591","Mon: 10<br />mean:  0.88170852<br />lcl:  0.72778262<br />ucl:  1.03934070","Mon: 11<br />mean:  0.86906041<br />lcl:  0.72237413<br />ucl:  1.01969342","Mon: 12<br />mean:  0.70986833<br />lcl:  0.57471401<br />ucl:  0.84966743","Mon: 12<br />mean:  0.70986833<br />lcl:  0.57471401<br />ucl:  0.84966743","Mon: 12<br />mean:  0.70986833<br />lcl:  0.57471401<br />ucl:  0.84966743","Mon: 11<br />mean:  0.86906041<br />lcl:  0.72237413<br />ucl:  1.01969342","Mon: 10<br />mean:  0.88170852<br />lcl:  0.72778262<br />ucl:  1.03934070","Mon:  9<br />mean:  0.06452193<br />lcl: -0.07069314<br />ucl:  0.20435591","Mon:  8<br />mean: -1.30142336<br />lcl: -1.45504041<br />ucl: -1.14389750","Mon:  7<br />mean: -1.99467099<br />lcl: -2.17033780<br />ucl: -1.81542085","Mon:  6<br />mean: -0.69175357<br />lcl: -0.84631231<br />ucl: -0.53340039","Mon:  5<br />mean:  0.46606820<br />lcl:  0.32237435<br />ucl:  0.61393881","Mon:  4<br />mean:  0.64599498<br />lcl:  0.49389496<br />ucl:  0.80194618","Mon:  3<br />mean: -0.05318649<br />lcl: -0.18951779<br />ucl:  0.08788087","Mon:  2<br />mean: -0.06075172<br />lcl: -0.19644074<br />ucl:  0.07967581","Mon:  1<br />mean:  0.44177942<br />lcl:  0.30651040<br />ucl:  0.58173093","Mon:  1<br />mean:  0.44177942<br />lcl:  0.30651040<br />ucl:  0.58173093"],"type":"scatter","mode":"lines","line":{"width":null,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(28,134,238,0.2)","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[0.441779415089002,-0.0607517194810534,-0.0531864908039458,0.64599498128986,0.466068195995284,-0.69175357356168,-1.99467099255948,-1.30142335673109,0.0645219290542525,0.8817085180193,0.869060405422184,0.709868333950288],"text":["Mon:  1<br />mean:  0.44177942<br />lcl:  0.30651040<br />ucl:  0.58173093","Mon:  2<br />mean: -0.06075172<br />lcl: -0.19644074<br />ucl:  0.07967581","Mon:  3<br />mean: -0.05318649<br />lcl: -0.18951779<br />ucl:  0.08788087","Mon:  4<br />mean:  0.64599498<br />lcl:  0.49389496<br />ucl:  0.80194618","Mon:  5<br />mean:  0.46606820<br />lcl:  0.32237435<br />ucl:  0.61393881","Mon:  6<br />mean: -0.69175357<br />lcl: -0.84631231<br />ucl: -0.53340039","Mon:  7<br />mean: -1.99467099<br />lcl: -2.17033780<br />ucl: -1.81542085","Mon:  8<br />mean: -1.30142336<br />lcl: -1.45504041<br />ucl: -1.14389750","Mon:  9<br />mean:  0.06452193<br />lcl: -0.07069314<br />ucl:  0.20435591","Mon: 10<br />mean:  0.88170852<br />lcl:  0.72778262<br />ucl:  1.03934070","Mon: 11<br />mean:  0.86906041<br />lcl:  0.72237413<br />ucl:  1.01969342","Mon: 12<br />mean:  0.70986833<br />lcl:  0.57471401<br />ucl:  0.84966743"],"type":"scatter","mode":"lines","line":{"width":null,"color":"rgba(28,134,238,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.45,12.55],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.51181102362205,"color":"rgba(238,44,44,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":48.5446243254462,"r":7.30593607305936,"b":47.3557492735575,"l":29.5558322955583},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"title":{"text":"Month within Year","font":{"color":"rgba(0,0,0,1)","family":"","size":22.3163138231631},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.45,12.55],"tickmode":"array","ticktext":["2.5","5.0","7.5","10.0","12.5"],"tickvals":[2.5,5,7.5,10,12.5],"categoryorder":"array","categoryarray":["2.5","5.0","7.5","10.0","12.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14.8775425487754},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Mon","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.33082172542479,1.19982462261624],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"mean","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.8775425487754}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"f84369d4b92":{"x":{},"y":{},"ymin":{},"ymax":{},"type":"scatter"},"f84739d1b86":{"x":{},"y":{},"ymin":{},"ymax":{}},"f8410a2c0f":{"yintercept":{}}},"cur_data":"f84369d4b92","visdat":{"f84369d4b92":["function (y) ","x"],"f84739d1b86":["function (y) ","x"],"f8410a2c0f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="plot-catch-versus-effort" class="level2">
<h2 class="anchored" data-anchor-id="plot-catch-versus-effort"><em>Plot catch versus effort</em></h2>
<p><em>Here we plot the model output where we show catch as a function of effort for each station. Note that these predictions will be shown for one selected year (year 2002 in this case) and month (September), whereas data scatterplot shows the full data.</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plot-cpue-through-time" class="level2">
<h2 class="anchored" data-anchor-id="plot-cpue-through-time"><em>Plot CPUE through time</em></h2>
<p><em>Now we plot CPUE through time for a selected station (station 1) and selected effort level (20K), for all months</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="BayesianINLA_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>