<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Egle Jakubaviciute, Asta Audzijonyte">

<title>Sustainable Inland Fisheries - JABBA example</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/sif_sm.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Sustainable Inland Fisheries</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://fishsizeproject.github.io/models/lt/index.html" rel="">
 <span class="menu-text">Lietuvi≈≥</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://fishsizeproject.github.io/models/index.html" rel="">
 <span class="menu-text">English</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">JABBA example</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../models.html" class="sidebar-item-text sidebar-link">Overview of models</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">CPUE standardisation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GLM_standardisation.html" class="sidebar-item-text sidebar-link">1. GLM based standardisation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Zero_inflated_model.html" class="sidebar-item-text sidebar-link">2. Zero inflated model for catch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Bayesian_inla.html" class="sidebar-item-text sidebar-link">3. Bayesian model</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Surplus production (SP) models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../surplus-production.html" class="sidebar-item-text sidebar-link">4. Understand SP models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../jabba_models.html" class="sidebar-item-text sidebar-link">5. SP models with JABBA</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Fish growth models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../von-bertalanffy.html" class="sidebar-item-text sidebar-link">6. Von-Bertallanfy growth</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../temperature_growth.html" class="sidebar-item-text sidebar-link">7. Temperature impacts on growth</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../growth_change.html" class="sidebar-item-text sidebar-link">8. Detecting growth changes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../detecting_size.html" class="sidebar-item-text sidebar-link">9. Detecting size changes</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Machine learning (ML) models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ML_fish_species.html" class="sidebar-item-text sidebar-link">10. ML for species identification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ML_fish_size.html" class="sidebar-item-text sidebar-link">11. ML for fish size estimation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Satellite data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../satelite_temp.html" class="sidebar-item-text sidebar-link">12. Getting temperature data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../satelite_chla.html" class="sidebar-item-text sidebar-link">13. Getting chlA data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Size based ecosystem models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../curonian_mizer.html" class="sidebar-item-text sidebar-link">14. Curonian lagoon model</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries">libraries</a></li>
  <li><a href="#data-sets" id="toc-data-sets" class="nav-link" data-scroll-target="#data-sets">### DATA sets</a></li>
  <li><a href="#all-data" id="toc-all-data" class="nav-link" data-scroll-target="#all-data">all data</a></li>
  <li><a href="#setup-and-run" id="toc-setup-and-run" class="nav-link" data-scroll-target="#setup-and-run">### SETUP AND RUN</a></li>
  <li><a href="#setup-model-parameters" id="toc-setup-model-parameters" class="nav-link" data-scroll-target="#setup-model-parameters">Setup model parameters</a></li>
  <li><a href="#run-schaeffer" id="toc-run-schaeffer" class="nav-link" data-scroll-target="#run-schaeffer">Run: Schaeffer</a></li>
  <li><a href="#run-fox" id="toc-run-fox" class="nav-link" data-scroll-target="#run-fox">Run: Fox</a></li>
  <li><a href="#run-pella" id="toc-run-pella" class="nav-link" data-scroll-target="#run-pella">Run: Pella</a></li>
  <li><a href="#make-outputs" id="toc-make-outputs" class="nav-link" data-scroll-target="#make-outputs">### MAKE OUTPUTS</a></li>
  <li><a href="#all-output-plots-into-directory" id="toc-all-output-plots-into-directory" class="nav-link" data-scroll-target="#all-output-plots-into-directory">all output plots into directory</a></li>
  <li><a href="#summary-plot-in-pdf" id="toc-summary-plot-in-pdf" class="nav-link" data-scroll-target="#summary-plot-in-pdf">summary plot in pdf</a></li>
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">### END</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">JABBA example</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Egle Jakubaviciute, Asta Audzijonyte </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries">libraries</h3>
<p>JABBA requires the installation of <a href="https://cran.r-project.org/">R</a> and <a href="https://sourceforge.net/projects/mcmc-jags/">JAGS</a> and the following R packages that can be directly installed within R</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

[[4]]
[1] TRUE

[[5]]
[1] TRUE

[[6]]
[1] TRUE

[[7]]
[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="data-sets" class="level3">
<h3 class="anchored" data-anchor-id="data-sets">### DATA sets</h3>
</section>
<section id="all-data" class="level3">
<h3 class="anchored" data-anchor-id="all-data">all data</h3>
<p>JABBA requires a minimum of two input comma-separated value files (.csv) in the form of catch and abundance indices. The <code>Catch</code> input file contains the time series of year and catch by weight, aggregated across fleets for the entire fishery. Missing catch years or catch values are not allowed. JABBA is formulated to accommodate abundance indices from multiple sources (i.e., fleets) in a single <code>cpue</code> file, which contains all considered abundance indices. The first column of the <code>cpue</code> input is year, which must match the range of years provided in the Catch file. In contrast to the <code>Catch</code> input, missing abundance index values are allowed, such that different abundance indices may correspond to smaller portions of the catch time series. Optionally, an additional <code>se</code> input can be passed onto JABBA, containing standard error estimates associated with the abundance indices on a log scale. The se input is a third file, structurally identical to the <code>cpue</code> input. Alternatively, this feature can be used to apply different weighting to individual abundance indices by assigning varying coefficients of variation (CV) to each time series. If such weighting is implemented, it is advised that the CV chosen for each indexed year approximates the observed standard error on the log scale, such that the data weights are congruent with expectations as to how well the model should fit these data.</p>
<p>JABBA provides provides the option to use a single averaged CPUE index instead of the individual abundance indices (see <em>2.5.1. State-Space model for averaging of abundance indices</em> in Winker et al, 2018). This feature can be activated by setting <code>meanCPUE = TRUE</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Year Species Total_catch  cpue_sc   cpue_SE
1 1992 StockA1      829.20 1.798236        NA
2 1993 StockA1      567.97 1.075917 0.5905036
3 1994 StockA1      402.71 2.685084 0.5794874
4 1995 StockA1      366.71 1.767176 0.5776929
5 1996 StockA1      447.09 1.871632 0.5793944
6 1997 StockA1      685.99 2.576474 0.5789248</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "StockA1"</code></pre>
</div>
</div>
<p>#StockA1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="st">"StockA1"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## select one species</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> <span class="fu">filter</span> (Species <span class="sc">==</span> species)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#indicate catch, cpue and SE of cpue</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>catch<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span> (Year, Total_catch)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>cpue <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Year, cpue_sc)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Year, cpue_SE)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(catch) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"catch"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cpue) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"cpue"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(se) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"se"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(catch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="JabbaModel_example_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cpue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="JabbaModel_example_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="JabbaModel_example_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="setup-and-run" class="level3">
<h3 class="anchored" data-anchor-id="setup-and-run">### SETUP AND RUN</h3>
</section>
<section id="setup-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="setup-model-parameters">Setup model parameters</h3>
<p>For surplus production models we basically need carrying capacity K and population growth rate r Since K and r are never known, a common approach is to set priors for K at 3-10 times the maximum catch in the catch time series, whereas r is assumed to be lognormally distributed with mean r of 0.2. But you can set it differently. Let‚Äôs also make projections into the future assuming that catch in the next 10 years will stay the same as the last year‚Äôs catch, be 50% smaller and 50% larger</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1012.672</code></pre>
</div>
</div>
<section id="setup-schaeffer" class="level4">
<h4 class="anchored" data-anchor-id="setup-schaeffer">setup: Schaeffer</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Schaeffer_both"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>input_both_sch <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">1</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>)[<span class="dv">1</span>],</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fl">0.01</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = ifelse(is.null(se), 0.1, 0.001),</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # optionally we can set a range in here</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; SE.I=FALSE: Creating cpue.se dummy matrix &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Schaefer &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.4and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="schaefer-with-cpue-se" class="level4">
<h4 class="anchored" data-anchor-id="schaefer-with-cpue-se">Schaefer with CPUE SE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Schaeffer_both"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>input_both_sch <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> se,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">1</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>)[<span class="dv">1</span>],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = 0.01,</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(se), <span class="fl">0.1</span>, <span class="fl">0.001</span>),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # we set a range in here</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Schaefer &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.4and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="setup-fox" class="level4">
<h4 class="anchored" data-anchor-id="setup-fox">setup: Fox</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Fox_both"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>input_both_fox <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">2</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>),</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fl">0.01</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = ifelse(is.null(se), 0.1, 0.001),</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # we set a range in here</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; SE.I=FALSE: Creating cpue.se dummy matrix &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Fox &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =1.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.25and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="fox-with-cpue-se" class="level4">
<h4 class="anchored" data-anchor-id="fox-with-cpue-se">Fox with CPUE SE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Fox_both"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>input_both_fox <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> se,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">2</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>),</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = 0.01,</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(se), <span class="fl">0.1</span>, <span class="fl">0.001</span>),</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # we set a range in here</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Fox &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =1.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.25and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="setup-pella" class="level4">
<h4 class="anchored" data-anchor-id="setup-pella">setup: Pella</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Pella_both"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>input_both_pella <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">NULL</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">3</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fl">0.01</span>,</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = ifelse(is.null(se), 0.1, 0.001),</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # we set a range in here</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; SE.I=FALSE: Creating cpue.se dummy matrix &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Pella &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =1.188</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.25and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="pella-with-cpue-se" class="level4">
<h4 class="anchored" data-anchor-id="pella-with-cpue-se">Pella with CPUE SE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>scenario_name <span class="ot">=</span> <span class="st">"Pella_both"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>input_both_pella <span class="ot">&lt;-</span> <span class="fu">build_jabba</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch =</span> catch,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpue =</span> cpue,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> se,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">assessment =</span> species,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> scenario_name,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.type =</span> <span class="fu">c</span>(<span class="st">"Schaefer"</span>, <span class="st">"Fox"</span>, <span class="st">"Pella"</span>, <span class="st">"Pella_m"</span>) [<span class="dv">3</span>],  <span class="co"># with [1] we select the first option</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">add.catch.CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.cv =</span> <span class="fl">0.1</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.error =</span> <span class="fu">c</span>(<span class="st">"random"</span>, <span class="st">"under"</span>) [<span class="dv">1</span>],          <span class="co">#"under" mean directional underreporting</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Plim =</span> <span class="fl">0.25</span>,                                    <span class="co">#limit of biomass where recruitment can become impaired Plim = Blim/K</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">1</span>],</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">r.prior =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.2</span>),             <span class="co">#IMPORTANT: What is the expected mean R and lognormal errors? Default is 0.2 and 0.25</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"range"</span>)[<span class="dv">2</span>],</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">K.prior =</span> <span class="fu">c</span>(Kmin,Kmax),</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.dist =</span> <span class="fu">c</span>(<span class="st">"lnorm"</span>, <span class="st">"beta"</span>),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi.prior =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">b.prior =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="fl">0.3</span>, <span class="cn">NA</span>, <span class="fu">c</span>(<span class="st">"bk"</span>, <span class="st">"bbmsy"</span>, <span class="st">"ffmsy"</span>)[<span class="dv">1</span>]),</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">BmsyK =</span> <span class="fl">0.4</span>,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape.CV =</span> <span class="fl">0.3</span>,</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.q =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.est =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.var =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(cpue) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fixed.obsE = 0.01,</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.obsE =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(se), <span class="fl">0.1</span>, <span class="fl">0.001</span>),</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma.proc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">proc.dev.all =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">igamma =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.01</span>),</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">projection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACs =</span> TAC_range, <span class="co"># we set a range in here</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TACs = c(350,1000), # we set a range in here</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TACint =</span> <span class="cn">NULL</span>,</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">imp.yr =</span> TAC_year,        <span class="co">#when does TAC start</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">pyrs =</span> <span class="dv">10</span>,            <span class="co">#how many years to project     </span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_bound =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">1.3</span>),</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaobs_bound =</span> <span class="dv">1</span>,</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigmaproc_bound =</span> <span class="fl">0.2</span>,</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_bounds =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">30</span>, <span class="dv">1000</span>),</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">K_bounds =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">10</span>),</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">harvest.label =</span> <span class="fu">c</span>(<span class="st">"Hmsy"</span>, <span class="st">"Fmsy"</span>)[<span class="dv">2</span>],</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">catch.metric =</span> <span class="st">"(t)"</span></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Prepare JABBA input data &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Assume Catch with error CV = 0.1 &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Model type:Pella &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Shape m =1.188</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; K prior mean =5803.66448900219and CV =0.307940901904413(log.sd = 0.300993201081484)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; r prior mean =0.25and CV =0.20201676710706(log.sd = 0.2)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Psi (B1/K) prior mean =0.6and CV =0.2withlnormdestribution</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>


&gt;&lt;&gt; ALWAYS ENSURE to adjust default settings to your specific stock &lt;&gt;&lt;</code></pre>
</div>
</div>
<p>#RUN. Make sure you have created a separate folder with species name, so that jabba would know where to put results</p>
</section>
</section>
<section id="run-schaeffer" class="level3">
<h3 class="anchored" data-anchor-id="run-schaeffer">Run: Schaeffer</h3>
<p>We will run Schaefer, Fox and Pella scenarios. They make different assumptions about density dependence. We run them with identical parameters and priors, but we expect to get different posterior estimates, because they assume a slightly different production curve</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a directory to save the output files</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(species) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dir.create(species): 'StockA1' already exists</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#note this will save an .RData object </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>run_both_sch <span class="ot">&lt;-</span> <span class="fu">fit_jabba</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  input_both_sch,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ni =</span> <span class="dv">30000</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nt =</span> <span class="dv">5</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nb =</span> <span class="dv">5000</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.values =</span> <span class="cn">FALSE</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.K =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.r =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.q =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">peels =</span> <span class="cn">NULL</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.trj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.jabba =</span> <span class="cn">TRUE</span>,  <span class="co">#will save the RData object</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.csvs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">output.dir =</span> species,  <span class="do">## make sure you create a folder in your working directory to save outputs</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">quickmcmc =</span> <span class="cn">TRUE</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>module glm loaded</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 92
   Unobserved stochastic nodes: 128
   Total graph size: 2350

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Produce results output of Schaefer model for StockA1 Schaeffer_both &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>

&gt;&lt;&gt; Scenario Schaeffer_both_Schaefer completed in 0 min and 34 sec &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; compiling Future Projections under fixed quota &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="run-fox" class="level3">
<h3 class="anchored" data-anchor-id="run-fox">Run: Fox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>run_both_fox <span class="ot">&lt;-</span> <span class="fu">fit_jabba</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  input_both_fox,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ni =</span> <span class="dv">30000</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nt =</span> <span class="dv">5</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nb =</span> <span class="dv">5000</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.values =</span> <span class="cn">FALSE</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.K =</span> <span class="cn">NULL</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.r =</span> <span class="cn">NULL</span>,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.q =</span> <span class="cn">NULL</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">peels =</span> <span class="cn">NULL</span>,</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.trj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.jabba =</span> <span class="cn">TRUE</span>,  <span class="co">#will save the RData object</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.csvs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">output.dir =</span> species,  <span class="do">## make sure you create a folder in your working directory to save outputs</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">quickmcmc =</span> <span class="cn">TRUE</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 92
   Unobserved stochastic nodes: 128
   Total graph size: 2350

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Produce results output of Fox model for StockA1 Fox_both &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>

&gt;&lt;&gt; Scenario Fox_both_Fox completed in 0 min and 33 sec &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; compiling Future Projections under fixed quota &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="run-pella" class="level3">
<h3 class="anchored" data-anchor-id="run-pella">Run: Pella</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>run_both_pella <span class="ot">&lt;-</span> <span class="fu">fit_jabba</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  input_both_pella,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ni =</span> <span class="dv">30000</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nt =</span> <span class="dv">5</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nb =</span> <span class="dv">5000</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.values =</span> <span class="cn">FALSE</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.K =</span> <span class="cn">NULL</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.r =</span> <span class="cn">NULL</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">init.q =</span> <span class="cn">NULL</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">peels =</span> <span class="cn">NULL</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.all =</span> <span class="cn">FALSE</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.trj =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.jabba =</span> <span class="cn">TRUE</span>,  <span class="co">#will save the RData object</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.csvs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">output.dir =</span> species,  <span class="do">## make sure you create a folder in your working directory to save outputs</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">quickmcmc =</span> <span class="cn">TRUE</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 92
   Unobserved stochastic nodes: 128
   Total graph size: 2350

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; Produce results output of Pella model for StockA1 Pella_both &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>

&gt;&lt;&gt; Scenario Pella_both_Pella completed in 0 min and 29 sec &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
&gt;&lt;&gt; compiling Future Projections under fixed quota &lt;&gt;&lt;</code></pre>
</div>
</div>
</section>
<section id="make-outputs" class="level3">
<h3 class="anchored" data-anchor-id="make-outputs">### MAKE OUTPUTS</h3>
</section>
<section id="all-output-plots-into-directory" class="level3">
<h3 class="anchored" data-anchor-id="all-output-plots-into-directory">all output plots into directory</h3>
<p>You can explore these plots from the working directory</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jabba_plots</span>(run_both_sch, <span class="at">output.dir =</span> species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_catch()  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_catcherror()  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_cpue() - fits to CPUE &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_cpue() - fits to CPUE &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_mcmc() - mcmc chains  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_ppist() - prior and posterior distributions  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_procdev() - Process error diviations on log(biomass)  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - B trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - F trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - BBmsy trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - FFmsy trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - BB0 trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_spphase() - JABBA Surplus Production Phase Plot  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_cpue() - fits to CPUE &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_runstest()   &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_summary()</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_kobe() - Stock Status Plot  &lt;&gt;&lt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="JabbaModel_example_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#jabba_plots(run_both_fox, output.dir = species)</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#jabba_plots(run_both_pella, output.dir = species)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-plot-in-pdf" class="level3">
<h3 class="anchored" data-anchor-id="summary-plot-in-pdf">summary plot in pdf</h3>
<p>If you want to generate your summary plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the data file, but it is always saved as name "jabba". Chose which file you want: Schaeffer, Fox or Pella</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">load</span>(<span class="at">file =</span> <span class="fu">paste0</span>(species,<span class="st">"/"</span>,species,<span class="st">"_Schaeffer_both_jabba.rdata"</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#load(file = paste0(species,"/",species,"_Fox_both_jabba.rdata"))</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load(file = paste0(species,"/",species,"_Pella_both_jabba.rdata"))</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a> <span class="co">#rename it, to not get confused</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a> model_out <span class="ot">&lt;-</span> jabba</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a> <span class="co">#make a name for a summary pdf file </span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="fu">paste0</span>(species,<span class="st">"/"</span>,species,<span class="st">"_summary.pdf"</span>), <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">12</span>)</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot various outputs </span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">jbplot_trj</span>(model_out,<span class="at">type=</span><span class="st">"BBmsy"</span>,<span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - BBmsy trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jbplot_trj</span>(model_out,<span class="at">type=</span><span class="st">"F"</span>,<span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_trj() - F trajectory  &lt;&gt;&lt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jbplot_catch</span>(model_out, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_catch()  &lt;&gt;&lt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jbplot_spphase</span>(model_out,<span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_spphase() - JABBA Surplus Production Phase Plot  &lt;&gt;&lt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jbplot_kobe</span>(model_out, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&gt;&lt;&gt; jbplot_kobe() - Stock Status Plot  &lt;&gt;&lt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="end" class="level3">
<h3 class="anchored" data-anchor-id="end">### END</h3>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>